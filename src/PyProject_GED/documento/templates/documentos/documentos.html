{% extends "base.html" %}
{% load i18n %}
{% block conteudo %}



<script type="text/javascript">
    $(document).ready( function() {
        $('#arvore').fileTree({
            root: '{{iPasta_Raiz}}',
            script: '/cria_arvore/',
            expandSpeed: 500,
            collapseSpeed: 500,
            multiFolder: false
        });
    });
</script>

<div class="container-fluid">
  <div class="row-fluid">
  	<div class="span3">
  		<h1>Documentos</h1>
  	</div>
	
	<div class="span9">
		<br />
	   <div class="subnav">
	    <ul class="nav nav-pills">
	      <li class=""><a class="fancybox fancybox.iframe" href="/importar_scanner/">Digitalizar Documento(s)</a></li>
	      <li class=""><a class="fancybox fancybox.iframe" href="/importar/">Importar Documento(s)</a></li>
	      <li class=""><a href="javascript:getsupport('assinarlote')">Assinar Documento(s)</a></li>
	      <li class=""><a href="javascript:getsupport('email')">Enviar E-mail</a></li>
	      <li class=""><a href="javascript:getsupport('publicar')">Enviar Publicação</a></li>
	    </ul>
	   </div>
	</div>
	</div>
	<div class="row-fluid">
		<div class="span3">
		  <div class="well">
		   <div id="arvore" ></div>
		  </div>
		</div>
	
		<div class="span9">
	   <form name= "acao" id="formTabela" action="" method="post">{% csrf_token %}
		<input type="hidden" name="supporttype" /> <!-- Não Deletar | Usado para submit em link-->
		{% if messages %}
		<div class="alert alert-info">
			<ul class="messages">
			    {% for message in messages %}
			    	<li{% if message.tags %} class="{{ message.tags }}"{% endif %}><b>{{ message }}</b></li>
			    {% endfor %}
			</ul>
		</div>
		{% endif %}
		<table id= "id_tabelaDocumentos" class="table table-striped table-bordered table-condensed">
			<thead>
			  <tr>
			    <th colspan="9"><center>Lista de Documentos</center></th>
			  </tr>
			  <tr>
			  	<th> </th>
			    <th><center>Protocolo</center></th>
			    <th><center>Assunto</center></th>
			    <th><center>Tipo</center></th>
			    <th><center>Estado</center></th>
			    <th><center>Criador</center></th>
			    <th><center>Versão</center></th>
			    <th><center>Criado em</center></th>
			    <th><center>Ação</center></th>
			  </tr>
			</thead>
			<tbody>
			{% for documento in iListaDocumentos %}
				<tr>
			    	<td>
			    		<label class="checkbox"><input type="checkbox" name="versao_{{documento.id_versao}}" value="option1"></label>
			    	</td>
			    	<td><center>{{documento.protocolo}}</center></td>
			    	<td>{{documento.assunto}}</td>
			    	<td>{{documento.tipo_documento}}</td>
			    	<td>{{documento.estado}}</td>
			    	<td>{{documento.criador}}</td>
			    	<td><center>{{documento.num_versao}}</center></td>
			    	<td><center>{{documento.data_criacao}}</center></td>
			    	<td>
			            <div class="btn-group">   
			            	{% if documento.id_estado == 5 %}
			            	<a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-plus-sign icon-white"></i> Informações    <span class="caret"></span></a>
			            	{% else %}
			            		{% if documento.tipoVisualizacao == 1 %}
			            			<a class="btn btn-primary" href="{{documento.caminhoVisualizar}}" target="_blank" title="{{documento.assunto}}"><i class="icon-camera icon-white"></i> Visualizar</a>
			            		{% endif %}
			            		{% if documento.tipoVisualizacao == 2 %}
			            			<a class="btn btn-primary fancybox" href="{{documento.caminhoVisualizar}}" data-fancybox-group="gallery" title="{{documento.assunto}}"><i class="icon-camera icon-white"></i> Visualizar</a>
			            		{% endif %}
			            		{% if documento.tipoVisualizacao == 3 %}
			            			<a class="btn btn-primary" href="/download/{{documento.id_versao}}/"><i class="icon-download-alt icon-white"></i>  Download</a>
			            		{% endif %}
			            		<button class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
			            	{% endif %}
			            	<ul class="dropdown-menu">
				            	{% if documento.id_estado == 7 %}
				            	<li><a class="fancybox fancybox.iframe" href="/aprovar_documento/{{documento.id_versao}}/"><i class="icon-thumbs-up"></i>  Aprovar</a></li><li><a class="fancybox fancybox.iframe" href="/reprovar_documento/%(iIDVersao)s/"><i class="icon-thumbs-down"></i>  Reprovar</a></li>
				            	{% endif %}
				            	{% if documento.id_estado == 1 or documento.id_estado == 3 or documento.id_estado == 4 %}
				            	<li><a class="fancybox fancybox.iframe" href="/checkout/{{documento.id_versao}}/"><i class="icon-edit"></i>  Check-out</a></li>
				            	{% endif %}
				            	{% if documento.id_estado == 1 %}
				            	<li><a class="fancybox fancybox.iframe" href="/encaminhar/{{documento.id_versao}}/"><i class="icon-share-alt"></i>  Encaminhar</a></li>
				            	{% endif %}
				            	{% if documento.id_estado == 2 %}
				            	<li><a class="fancybox fancybox.iframe" href="/checkin/{{documento.id_versao}}/"><i class="icon-share"></i>  Check-in</a></li>
				            	{% endif %}
				            	{% if documento.id_estado == 1 %}
				            	<li class="divider"></li>
				            	<li><a class="fancybox fancybox.iframe" href="/excluir_documento/{{documento.id_versao}}/"><i class="icon-trash"></i>  Excluir</a></li>
				            	{% endif %}
				         		<li class="divider"></li><li><a class="fancybox fancybox.iframe" href="/historico/{{documento.id_versao}}/"><i class="icon-book"></i>  Histórico</a></li>
				         	</ul>
				         </div>
					</td>
				</tr>
			  {% empty %}
			  {% endfor %}		  
			</tbody>
		</table>
	</form>
	</div>
	</div>
	</div>

{% endblock conteudo %}